<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Javascript 忍者秘籍（第二版） | NMSN</title>
    <meta name="description" content="Somebody has to win, so why not be me?">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/favicon.ico">
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?6594ba1364804631f0a8fd4452766fed";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  <script aysnc="true" src="https://www.googletagmanager.com/gtag/js?id=UA-127895888-1"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-127895888-1');
  </script>
    
    <link rel="preload" href="/assets/css/0.styles.ec7a9dc7.css" as="style"><link rel="preload" href="/assets/js/app.a3917c08.js" as="script"><link rel="preload" href="/assets/js/2.143bf0e2.js" as="script"><link rel="preload" href="/assets/js/10.bfb12f17.js" as="script"><link rel="prefetch" href="/assets/js/11.95c30092.js"><link rel="prefetch" href="/assets/js/12.02d03ade.js"><link rel="prefetch" href="/assets/js/13.ed7b9bad.js"><link rel="prefetch" href="/assets/js/14.8b04c144.js"><link rel="prefetch" href="/assets/js/15.62e6c8b5.js"><link rel="prefetch" href="/assets/js/16.58442e8f.js"><link rel="prefetch" href="/assets/js/17.e5bd374d.js"><link rel="prefetch" href="/assets/js/18.aadb3349.js"><link rel="prefetch" href="/assets/js/19.8cb53d4b.js"><link rel="prefetch" href="/assets/js/20.24639fc6.js"><link rel="prefetch" href="/assets/js/21.f95ffdf3.js"><link rel="prefetch" href="/assets/js/22.2482e250.js"><link rel="prefetch" href="/assets/js/23.2e87cad5.js"><link rel="prefetch" href="/assets/js/24.ac878c31.js"><link rel="prefetch" href="/assets/js/25.5be9f82b.js"><link rel="prefetch" href="/assets/js/26.2a5b4ac3.js"><link rel="prefetch" href="/assets/js/27.935732a6.js"><link rel="prefetch" href="/assets/js/28.c12cbcea.js"><link rel="prefetch" href="/assets/js/29.5b94311f.js"><link rel="prefetch" href="/assets/js/3.13e2822a.js"><link rel="prefetch" href="/assets/js/30.f4d6df45.js"><link rel="prefetch" href="/assets/js/31.bf46b8c3.js"><link rel="prefetch" href="/assets/js/32.633ca84c.js"><link rel="prefetch" href="/assets/js/33.e267b1b5.js"><link rel="prefetch" href="/assets/js/34.83fdc5e8.js"><link rel="prefetch" href="/assets/js/35.2078f29f.js"><link rel="prefetch" href="/assets/js/36.cfbb8f18.js"><link rel="prefetch" href="/assets/js/37.c832ebab.js"><link rel="prefetch" href="/assets/js/38.665cfa69.js"><link rel="prefetch" href="/assets/js/39.e5a858e9.js"><link rel="prefetch" href="/assets/js/4.5a3029b5.js"><link rel="prefetch" href="/assets/js/40.e32b8d9a.js"><link rel="prefetch" href="/assets/js/41.b05a12ad.js"><link rel="prefetch" href="/assets/js/42.b88c39a2.js"><link rel="prefetch" href="/assets/js/43.7b60d519.js"><link rel="prefetch" href="/assets/js/44.2f2414b2.js"><link rel="prefetch" href="/assets/js/45.85718f44.js"><link rel="prefetch" href="/assets/js/46.2bc30dd4.js"><link rel="prefetch" href="/assets/js/47.d15abaed.js"><link rel="prefetch" href="/assets/js/48.1e4e667c.js"><link rel="prefetch" href="/assets/js/49.6b1a9b49.js"><link rel="prefetch" href="/assets/js/5.ed6093fe.js"><link rel="prefetch" href="/assets/js/50.d3cc69ed.js"><link rel="prefetch" href="/assets/js/51.5c6a9aaf.js"><link rel="prefetch" href="/assets/js/52.fac8e285.js"><link rel="prefetch" href="/assets/js/53.e52aa3fd.js"><link rel="prefetch" href="/assets/js/54.18b8b153.js"><link rel="prefetch" href="/assets/js/55.67f9bbbf.js"><link rel="prefetch" href="/assets/js/56.1a846f2d.js"><link rel="prefetch" href="/assets/js/57.6a72fd81.js"><link rel="prefetch" href="/assets/js/58.85b90b3e.js"><link rel="prefetch" href="/assets/js/59.f66f3400.js"><link rel="prefetch" href="/assets/js/6.6b149b80.js"><link rel="prefetch" href="/assets/js/60.7f20d436.js"><link rel="prefetch" href="/assets/js/61.2070b510.js"><link rel="prefetch" href="/assets/js/62.dbcc46f4.js"><link rel="prefetch" href="/assets/js/7.473a6114.js"><link rel="prefetch" href="/assets/js/8.0cbdd451.js"><link rel="prefetch" href="/assets/js/9.8148293e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ec7a9dc7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NMSN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tech/" class="nav-link">
  快查总结
</a></div><div class="nav-item"><a href="/excerpt/" class="nav-link">
  摘录
</a></div><div class="nav-item"><a href="/interviewQuestions/" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/readingNotes/" class="nav-link router-link-active">
  读书笔记
</a></div><div class="nav-item"><a href="/work/" class="nav-link">
  工作总结
</a></div> <a href="https://github.com/nmsn" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tech/" class="nav-link">
  快查总结
</a></div><div class="nav-item"><a href="/excerpt/" class="nav-link">
  摘录
</a></div><div class="nav-item"><a href="/interviewQuestions/" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/readingNotes/" class="nav-link router-link-active">
  读书笔记
</a></div><div class="nav-item"><a href="/work/" class="nav-link">
  工作总结
</a></div> <a href="https://github.com/nmsn" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>读书笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/readingNotes/Linux.html" class="sidebar-link">鸟哥的Linux私房菜基础学习篇</a></li><li><a href="/readingNotes/了不起的Nodejs.html" class="sidebar-link">了不起的Node.js</a></li><li><a href="/readingNotes/深入浅出Nodejs.html" class="sidebar-link">深入浅出Nodejs</a></li><li><a href="/readingNotes/代码整洁之道.html" class="sidebar-link">代码整洁之道</a></li><li><a href="/readingNotes/HTTP权威指南.html" class="sidebar-link">HTTP权威指南</a></li><li><a href="/readingNotes/ProGit.html" class="sidebar-link">ProGit</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-忍者秘籍（第二版）"><a href="#javascript-忍者秘籍（第二版）" aria-hidden="true" class="header-anchor">#</a> Javascript 忍者秘籍（第二版）</h1> <h2 id="_3-4-函数的实参和形参"><a href="#_3-4-函数的实参和形参" aria-hidden="true" class="header-anchor">#</a> 3.4 函数的实参和形参</h2> <ul><li>形参是我们定义函数时所列举的变量</li> <li>实参是我们调用函数时所传递给函数的值</li></ul> <h3 id="_4-3-1-使用箭头函数绕过函数上下文"><a href="#_4-3-1-使用箭头函数绕过函数上下文" aria-hidden="true" class="header-anchor">#</a> 4.3.1 使用箭头函数绕过函数上下文</h3> <p>箭头函数作为回调函数还有一个更优秀的特性:箭头函数没有单独的this值。箭头函数的this与声明所在的上下文的相同。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>clicked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">click</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>clicked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">,</span> <span class="token string">&quot;The button has been clicked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>调用箭头函数时，不会隐式传入this参数，而是从定义时的函数继承上下文。在本例中，箭头函数在构造函数内部，this指向新创建的对象本身，因此无论何时调用click函数，this都将指向新创建的button对象。</p> <h3 id="_5-4-2-代码嵌套与词法环境"><a href="#_5-4-2-代码嵌套与词法环境" aria-hidden="true" class="header-anchor">#</a> 5.4.2 代码嵌套与词法环境</h3> <p>无论何时创建函数，都会创建一个与之相关联的词法环境，并存储 在名为[[Environment]]的内部属性上(也就是说无法直接访问或操作)。两个中括号用于标志内部属性。</p> <p>无论何时调用函数，都会创建一个新的执行环境，被推入执行上下 文栈。此外，还会创建一个与之相关联的词法环境。现在来看最重要的部分:外部环境与新建的词法环境，JavaScript引擎将调用函数的内置[[Environment]]属性与创建函数时的环境进行关联。</p> <h3 id="_5-5-2-定义变量的关键字和词法环境"><a href="#_5-5-2-定义变量的关键字和词法环境" aria-hidden="true" class="header-anchor">#</a> 5.5.2 定义变量的关键字和词法环境</h3> <ul><li>for循环存在块状作用域</li> <li>关键字var定义的变量忽略块状作用域</li></ul> <h3 id="_5-5-3-在词法环境中注册标识符"><a href="#_5-5-3-在词法环境中注册标识符" aria-hidden="true" class="header-anchor">#</a> 5.5.3 在词法环境中注册标识符</h3> <p>JavaScript 代码执行分为两个阶段</p> <ol><li>没有执行代码，但是 JavaScript 引擎会访问并注册在当前词法环境中所声明的变量和函数</li> <li>第二阶段
<ol><li>如果是创建一个函数环境，那么创建形参及函数参数的默认值。如果是非函数环境，将跳过此过程。</li> <li>如果是创建全局或函数环境，就扫描当前代码进行函数声明（不会扫描其他函数的函数体），但是不会扫描函数表达式或箭头函数。对于所找到的函数声明，将创建函数，并绑定到当前环境与函数名形同的标识符上。<strong>若标识符已经存在，那么该标识符的值将被重写</strong>。如果是块级作用域，将跳过此步骤。</li> <li>扫描当前代码进行变量声明。在函数或全局环境中，找到所有当前函数以及其他函数之外通过var声明的变量，并找到所有在其他函数或代码块之外通过let或const定义的变量。在块级环境中，仅查找当前 块中通过let或const定义的变量。对于所查找到的变量，若该标识符不存在，进行注册并将其初始化为undefined。<strong>若该标识符已经存在，将保留其值</strong>。</li></ol></li></ol> <h2 id="_5-7-小结"><a href="#_5-7-小结" aria-hidden="true" class="header-anchor">#</a> 5.7 小结</h2> <ul><li>JavaScript 引擎通过此法案环境跟踪标识符（俗称作用域）</li></ul> <h3 id="_6-2-2-使用生成器"><a href="#_6-2-2-使用生成器" aria-hidden="true" class="header-anchor">#</a> 6.2.2 使用生成器</h3> <p>用生成器生成ID序列</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">IdGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token operator">++</span>id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> idIterator <span class="token operator">=</span> <span class="token function">IdGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> id1 <span class="token operator">=</span> IdIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token keyword">const</span> id2 <span class="token operator">=</span> IdIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre></div><h3 id="_6-2-4-探索生成器内部构成"><a href="#_6-2-4-探索生成器内部构成" aria-hidden="true" class="header-anchor">#</a> 6.2.4 探索生成器内部构成</h3> <p>迭代器执行过程</p> <ul><li>挂起开始——创建了一个生成器后，它最先以这种状态开始。其中的任何代码都未执行。</li> <li>执行——生成器中的代码执行的状态。执行要么是刚开始，要么是从上次挂起的时候继续的。当生成器对应的迭代器调用了 next 方法，并且当前存在可执行的代码时，生成器都会转移到这个状态。</li> <li>挂起让渡——当生成器在执行过程中遇到了一个 yield 表达式，它会创建一个包含着返回值的新对象，随后再挂起执行。生成器在这个状态暂停并等待继续执行。</li> <li>完成——在生成器执行期间，如果代码执行到 return 语句或者全部代码执行完毕，生成器就进入该状态。</li></ul> <p>通过执行上下文跟踪生成器函数</p> <ul><li>当我们调用生成器函数时，控制流则进入了生成器，正如进入任何其他函数一样，当前将会创建一个新的函数环境上下文和相对应的词法字典并列，并将该上下文入栈。而生成器比较特殊，它不会执行任何函数代码。取而代之则生成一个新的迭代器再从中返回，通过在代码中用生成的迭代器变量可以来引用这个迭代器。由于迭代器是用来控制生成器的执行的，故而迭代器中保存着一个在它创建位置处的执行上下文。</li> <li>当程序从生成器中执行完毕后，发生了一个有趣的现象。一般情况下，当程序从一个标准函数返回后，对应的执行环境上下文会从栈中弹出，并被完整地销毁。但在生成器中不是这样。</li> <li>相对应的生长期会从栈中弹出，但由于迭代器还保存着对它的引用，所以它不会被销毁。你可以把它看作一种类似闭包的事物。在闭包中，为了在闭包创建的时候保证变量都可用，所以函数会对创建它的环境持有一个引用。以这种方式，我们能保证只要函数还存在，环境及变量就都存在着。生成器，从另一个角度看，还必须恢复执行。由于所有函数的执行都被执行上下文所控制，故而迭代器保持了一 个对当前执行环境的引用，保证只要迭代器还需要它的时候它都存在。</li> <li>如果这只是一个普通的函数调用，这个语句会创建一个新的 next() 的执行环境上下文项，并放入栈中。但你可能注意到了，生成器绝不标准，对next方法调用的表现也很不同。它会重新激活对应的执行上下文，并把该上下文放入栈的 顶部，从它上次离开的地方继续执行。</li></ul> <h2 id="_7-1-理解原型"><a href="#_7-1-理解原型" aria-hidden="true" class="header-anchor">#</a> 7.1 理解原型</h2> <p>测试对象是否具有某一个特定的属性，我们可以使用操作符 in。</p> <p>在 JavaScrip中，对象的原型属性是内置属性（使用标记[[prototype]]），无法直接访问</p> <p>内置的Object.setPrototypeOf需要传入两个对象作为番薯，并将第二个参数对象设置为第一个对象的原型</p> <h3 id="_7-2-2-javascript-动态特性的副作用"><a href="#_7-2-2-javascript-动态特性的副作用" aria-hidden="true" class="header-anchor">#</a> 7.2.2 JavaScript 动态特性的副作用</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>swung <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ninja1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Ninja</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">swingSword</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>swung<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用字面量对象重写 Ninja 的原型对象，仅有一个 pierce 方法</span>

ninja1<span class="token punctuation">.</span><span class="token function">swingSword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 尽管我们已经完全替换了Ninja的构造器原型，但是实例化后的 Ninja 对象扔具有 swingSword 方法，因为对象 ninja1 仍然保持着对旧的 Ninja 原型的引用</span>

<span class="token class-name">Ninja</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">pierce</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>	
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ninja1<span class="token punctuation">.</span><span class="token function">swingSword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ninja2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ninja2<span class="token punctuation">.</span><span class="token function">pierce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ninja2<span class="token punctuation">.</span>swingSword<span class="token punctuation">;</span>
<span class="token comment">// 新创建的 ninja2 实例拥有新原型的引用，因此不具有 swingSword 方法，仅具有 pierce 方法</span>
</code></pre></div><p><img src="/assets/img/Snipaste_2020-11-03_21-16-27.c794a952.png" alt="Snipaste_2020-11-03_21-16-27"></p> <h2 id="_7-3-实现继承"><a href="#_7-3-实现继承" aria-hidden="true" class="header-anchor">#</a> 7.3 实现继承</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Ninja</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 丢失原始 Ninja.prototype 对象</span>

<span class="token keyword">const</span> ninja <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/Snipaste_2020-11-03_22-53-24.894b372b.png" alt="Snipaste_2020-11-03_22-53-24"></p> <h3 id="_7-3-1-重写-constructor-属性的问题"><a href="#_7-3-1-重写-constructor-属性的问题" aria-hidden="true" class="header-anchor">#</a> 7.3.1 重写 constructor 属性的问题</h3> <p>通过设置 Person 实例对象作为 Ninja 构造器的原型时，我们丢失了 Ninja 与 Ninja 初始原型之间的关联。</p> <div class="language-js extra-class"><pre class="language-js"><code>ninja<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Ninja <span class="token comment">// 失败，如上图所示，会找到 Person</span>
</code></pre></div><p>通过使用 Object.defineProperty 来给 Ninja.prototype 增加新的 constructor 属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dance</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Ninja</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Ninja</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Ninja</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'constructor'</span>， <span class="token punctuation">{</span>
	enumerable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 定义新的不可枚举的 constructor 属性，属性值为 Ninja </span>
	value<span class="token punctuation">:</span> Ninja<span class="token punctuation">,</span>
	writable<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ninja <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ninja<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Ninja<span class="token punctuation">;</span> <span class="token comment">// 成功</span>
</code></pre></div><h3 id="_8-1-1-定义-getter-和-setter"><a href="#_8-1-1-定义-getter-和-setter" aria-hidden="true" class="header-anchor">#</a> 8.1.1 定义 getter 和 setter</h3> <p>在对象字面量中定义 getter 和 setter</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ninjaCollection <span class="token operator">=</span> <span class="token punctuation">{</span>
  ninjas<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">get</span> <span class="token function">firstNinja</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'Getting firstNinja'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ninjas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">set</span> <span class="token function">firstNinja</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'Setting firstNinja'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ninjas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ninjaCollection<span class="token punctuation">.</span>firstNinja <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">;</span> <span class="token comment">// get</span>
ninjaCollection<span class="token punctuation">.</span>firstNinja <span class="token operator">=</span> <span class="token string">'d'</span><span class="token punctuation">;</span> <span class="token comment">// set</span>
</code></pre></div><p>在 class 中使用 getter 和 setter</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">NinjaCollection</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ninjas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">get</span> <span class="token function">firstNinja</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'Getting firstNinja'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ninjas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">set</span> <span class="token function">firstNinja</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'Setting firstNinja'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ninja<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ninjaCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NinjaCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ninjaCollection<span class="token punctuation">.</span>firstNinja <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">;</span> <span class="token comment">// get</span>
ninjaCollection<span class="token punctuation">.</span>firstNinja <span class="token operator">=</span> <span class="token string">'d'</span><span class="token punctuation">;</span> <span class="token comment">//set</span>
</code></pre></div><p>通过 Object.defineProperty 定义 getter 和 setter</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> _skillLevel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'skillLevel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'The get method is called'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> _skillLevel<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">report</span><span class="token punctuation">(</span><span class="token string">'The set method is called'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      _skillLevel <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ninja <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ninja</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ninja<span class="token punctuation">.</span>_skillLevel <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
ninja<span class="token punctuation">.</span>_skillLevel <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_8-2-使用代理控制访问"><a href="#_8-2-使用代理控制访问" aria-hidden="true" class="header-anchor">#</a> 8.2 使用代理控制访问</h2> <p>通过 Proxy 构造器创建代理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> representative <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>emperor<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">report</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Reading </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> through a proxy`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> key <span class="token keyword">in</span> target <span class="token operator">?</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'Don`t bother the emperor'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  	<span class="token function">report</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Writing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> through a proxy`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_8-2-3-使用代理自动填充属性"><a href="#_8-2-3-使用代理自动填充属性" aria-hidden="true" class="header-anchor">#</a> 8.2.3 使用代理自动填充属性</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">report</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Reading </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>property <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">[</span>property<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> rootFolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  rootFolder<span class="token punctuation">.</span>ninjasDir<span class="token punctuation">.</span>firstNinjaDir<span class="token punctuation">.</span>ninjaFile <span class="token operator">=</span> <span class="token string">'yoshi.txt'</span><span class="token punctuation">;</span>
 	<span class="token comment">// 每当访问属性时，都会执行代理方法，若该属性不存在，则创建该属性</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用代理不会抛出异常</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8-2-5-代理的性能消耗"><a href="#_8-2-5-代理的性能消耗" aria-hidden="true" class="header-anchor">#</a> 8.2.5 代理的性能消耗</h2> <p>尽管使用代理可以创造性地控制对 象的访问，但是大量的控制操作将带来性能问题。可以在多性能不敏感 的程序里使用代理，但是若多次执行代码时仍然要小心谨慎。像往常一 样，我们建议你彻底地测试代码的性能。</p> <h3 id="_9-2-1-别把对象当作-map"><a href="#_9-2-1-别把对象当作-map" aria-hidden="true" class="header-anchor">#</a> 9.2.1 别把对象当作 Map</h3> <p>由于这两个原因:</p> <ol><li>原型继承属性</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> dictionary <span class="token operator">=</span> <span class="token punctuation">{</span>
  ja<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;Ninjas for hire&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;レンタル用の忍者&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token string">&quot;zh&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;Ninjas for hire&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;忍者出租&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  ko<span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token string">&quot;Ninjas for hire&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;고용 닌자&quot;</span>
   
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">assert</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">.</span>ja<span class="token punctuation">[</span><span class="token string">&quot;Ninjas for hire&quot;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;レンタル用の忍者&quot;</span><span class="token punctuation">,</span>     <span class="token string">&quot;We know how to say 'Ninjas for hire' in Japanese!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> dictionary<span class="token punctuation">.</span>ja<span class="token punctuation">[</span><span class="token string">&quot;constructor&quot;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">,</span>     dictionary<span class="token punctuation">.</span>ja<span class="token punctuation">[</span><span class="token string">&quot;constructor&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>视同访问 constructor 属性，这是在字典中未定义的单词。在本例中我们期望字典返回 undefined。但是结果并非如此，返回的结果为 <code>&quot;function Object() { [native code] }&quot;</code></p> <ol start="2"><li>key仅支持字符串</li></ol> <p>所以通常 不能使用对象作为map。由于这种限制，ECMAScript委员会定义了一个 全新类型: Map</p> <h2 id="_13-1-深入事件循环"><a href="#_13-1-深入事件循环" aria-hidden="true" class="header-anchor">#</a> 13.1 深入事件循环</h2> <ul><li><p>宏任务的例子很多，包括创建主文档对象、解析HTML、执行主线 (或全局)JavaScript代码，更改当前URL以及各种事件，如页面加载、 输入、网络事件和定时器事件。从浏览器的角度来看，宏任务代表一个 个离散的、独立工作单元。运行完任务后，浏览器可以继续其他调度， 如重新渲染页面的UI或执行垃圾回收。</p></li> <li><p>而微任务是更小的任务。微任务更新应用程序的状态，但必须在浏 览器任务继续执行其他任务之前执行，浏览器任务包括重新渲染页面的 UI。微任务的案例包括promise回调函数、DOM发生变化等。微任务需 要尽可能快地、通过异步方式执行，同时不能产生全新的微任务。微任 务使得我们能够在重新渲染UI之前执行指定的行为，避免不必要的UI重 绘，UI重绘会使应用程序的状态不连续。</p></li></ul> <p>事件循环基于两个基本原则：</p> <ul><li>一次处理一个任务</li> <li>一个任务开始后直到运行完成，不会被其他任务中断</li></ul> <p><img src="/assets/img/Snipaste_2020-11-24_23-04-18.3efd27ce.png" alt="Snipaste_2020-11-24_23-04-18"></p> <p>事件循环将首先检查宏任 务队列，如果宏任务等待，则立即开始执行宏任务。直到该任务运行完 成(或者队列为空)，事件循环将移动去处理微任务队列。如果有任务 在该队列中等待，则事件循环将依次开始执行，完成一个后执行余下的 微任务，直到队列中所有微任务执行完毕。注意处理宏任务和微任务队 列之间的区别:单次循环迭代中，最多处理一个宏任务(其余的在队列 中等待)，而队列中的所有微任务都会被处理。</p> <ul><li>两类任务队列都是独立于事件循环的，这意味着任务队列的添加行 为也发生在事件循环之外。如果不这样设计，则会导致在执行 JavaScript代码时，发生的任何事件都将被忽略。正因为我们不希望 看到这种情况，因此检测和添加任务的行为，是独立于事件循环完成的。</li> <li>因为JavaScript基于单线程执行模型，所以这两类任务都是逐个执行 的。当一个任务开始执行后，在完成前，中间不会被任何其他任务 中断。除非浏览器决定中止执行该任务，例如，某个任务执行时间 过长或内存占用过大。</li> <li>所有微任务会在下一次渲染之前执行完成，因为它们的目标是在渲 染前更新应用程序状态。</li> <li>浏览器通常会尝试每秒渲染60次页面，以达到每秒60帧(60 fps) 的速度。60fps通常是检验体验是否平滑流畅的标准，比方在动画 里——这意味着浏览器会尝试在16ms内渲染一帧。需要注意图13.1 所示的“更新渲染”是如何发生在事件循环内的，因为在页面渲染 时，任何任务都无法再进行修改。 这些设计和原则都意味着，如果想要实现平滑流畅的应用，我们是没有太多时间浪费在处理单个 事件循环任务的。理想情况下，单个任务和该任务附属的所有微任 务，都应在16ms内完成。</li></ul> <h3 id="_13-2-1-在事件循环中执行计时器"><a href="#_13-2-1-在事件循环中执行计时器" aria-hidden="true" class="header-anchor">#</a> 13.2.1 在事件循环中执行计时器</h3> <p>如果interval事件触发，并且队列中已经有对应的任务等待执行时，则不会再添加新任务</p> <p>计时器提供一种异步延迟执行代 码片段的能力，至少要延迟指定的毫秒数。因为JavaScript单线程的本质，我们只能控制计时器何时被加入队列中，而无法控制何时执行。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">repeatMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/* Some long block of code... */</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>repeatMe<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   ⇽<span class="token operator">--</span><span class="token operator">-</span> 注册延迟任务，每<span class="token number">10</span>ms重新执行自身（任务本身执行后才）


<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* Some long block of code... */</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ⇽<span class="token operator">--</span><span class="token operator">-</span> 注册周期任务，每<span class="token number">10</span>ms执行一次任务
</code></pre></div><p>两段代码看起来功能是等价的，但实际未必。很明显，setTimeout 内的代码在前一个回调函数执行完成之后，至少延迟10ms执行(取决于事件队列的状态，等待时间只会大于10ms);</p> <p>而setInterval会尝试每 10ms 执行回调函数，不关心前一个回调函数是否执行。从上一节的例子中可以看到，间隔执行函数可以一个接一个地依次执行。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022/2/15 下午3:38:50</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a3917c08.js" defer></script><script src="/assets/js/2.143bf0e2.js" defer></script><script src="/assets/js/10.bfb12f17.js" defer></script>
  </body>
</html>
